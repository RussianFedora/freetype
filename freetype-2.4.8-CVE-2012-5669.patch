--- freetype-2.4.8/src/bdf/bdflib.c	2013-01-24 15:30:15.000000000 +0100
+++ freetype-2.4.8/src/bdf/bdflib.c	2013-01-24 15:30:32.269960403 +0100
@@ -1600,10 +1600,11 @@
       if ( p->glyph_enc < -1 )
         p->glyph_enc = -1;
 
-      /* Check that the encoding is in the range [0,65536] because */
-      /* otherwise p->have (a bitmap with static size) overflows.  */
-      if ( p->glyph_enc > 0                               &&
-           (size_t)p->glyph_enc >= sizeof ( p->have ) * 8 )
+      /* Check that the encoding is in the Unicode range because  */
+      /* otherwise p->have (a bitmap with static size) overflows. */
+      if ( p->glyph_enc > 0                                      &&
+           (size_t)p->glyph_enc >= sizeof ( p->have ) /
+                                   sizeof ( unsigned long ) * 32 )
       {
         error = BDF_Err_Invalid_File_Format;
         goto Exit;
