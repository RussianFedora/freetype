--- freetype-2.5.3/src/sfnt/pngshim.c
+++ freetype-2.5.3/src/sfnt/pngshim.c
@@ -269,6 +269,20 @@
       map->pitch      = map->width * 4;
       map->num_grays  = 256;
 
+      /* reject bitmaps with negative dimensions */
+      if ( map->rows < 0 || map->width < 0 )
+      {
+        error = FT_THROW( Invalid_Argument );
+        goto DestroyExit;
+      }
+
+      /* reject too large bitmaps similarly to the rasterizer */
+      if ( map->rows > 0x7FFF || map->width > 0x7FFF )
+      {
+        error = FT_THROW( Array_Too_Large );
+        goto DestroyExit;
+      }
+
       size = map->rows * map->pitch;
 
       error = ft_glyphslot_alloc_bitmap( slot, size );
